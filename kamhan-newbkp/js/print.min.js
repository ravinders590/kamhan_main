!function(e){"use strict";function t(t,n,r){var o,a,i,l,c,d=e(t),s=d.clone(n,r),f=d.find("textarea").add(d.filter("textarea")),p=s.find("textarea").add(s.filter("textarea")),u=d.find("select").add(d.filter("select")),h=s.find("select").add(s.filter("select")),y=d.find("canvas").add(d.filter("canvas")),m=s.find("canvas").add(s.filter("canvas"));for(o=0,a=f.length;o<a;++o)e(p[o]).val(e(f[o]).val());for(o=0,a=u.length;o<a;++o)for(i=0,l=u[o].options.length;i<l;++i)!0===u[o].options[i].selected&&(h[o].options[i].selected=!0);for(o=0,a=y.length;o<a;++o)(c=y[o].getContext("2d"))&&(m[o].getContext("2d").drawImage(y[o],0,0),e(m[o]).attr("data-jquery-print",c.canvas.toDataURL()));return s}function n(n){var r=e("");try{r=t(n)}catch(t){r=e("<span />").html(n)}return r}function r(t,n,r){var o,a,i,l,c,d,s,f=e.Deferred();try{t=t.contentWindow||t.contentDocument||t;try{t.resizeTo(window.innerWidth,window.innerHeight)}catch(e){console.warn(e)}o=t.document||t.contentDocument||t,r.doctype&&o.write(r.doctype),o.write(n);try{for(a=o.querySelectorAll("canvas"),i=0;i<a.length;i++)l=a[i].getContext("2d"),(c=new Image).onload=function(){l.drawImage(c,0,0)},c.src=a[i].getAttribute("data-jquery-print")}catch(e){console.warn(e)}o.close(),d=!1,s=function(){if(!d){t.focus();try{t.document.execCommand("print",!1,null)||t.print(),e("body").focus()}catch(e){t.print()}t.close(),d=!0,f.resolve()}},e(t).on("load",s),setTimeout(s,r.timeout)}catch(e){f.reject(e)}return f}function o(t,n){var o=e(n.iframe+""),i=o.length;return 0===i&&(o=e('<iframe height="0" width="0" border="0" wmode="Opaque"/>').prependTo("body").css({position:"absolute",top:-999,left:-999})),r(o.get(0),t,n).done((function(){setTimeout((function(){0===i&&o.remove()}),1e3)})).fail((function(e){console.error("Failed to print from iframe",e),a(t,n)})).always((function(){try{n.deferred.resolve()}catch(e){console.warn("Error notifying deferred",e)}}))}function a(e,t){return r(window.open(),e,t).always((function(){try{t.deferred.resolve()}catch(e){console.warn("Error notifying deferred",e)}}))}function i(e){return!!("object"==typeof Node?e instanceof Node:e&&"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName)}e.print=e.fn.print=function(){var r,l,c,d,s,f,p,u,h=this;if(h instanceof e&&(h=h.get(0)),i(h)?(l=e(h),arguments.length>0&&(r=arguments[0])):arguments.length>0?i((l=e(arguments[0]))[0])?arguments.length>1&&(r=arguments[1]):(r=arguments[0],l=e("html")):l=e("html"),c={globalStyles:!0,mediaPrint:!1,stylesheet:null,noPrintSelector:".no-print",iframe:!0,append:null,prepend:null,manuallyCopyFormValues:!0,deferred:e.Deferred(),timeout:750,title:null,doctype:"<!doctype html>"},r=e.extend({},c,r||{}),d=e(""),r.globalStyles?d=e("style, link, meta, base, title"):r.mediaPrint&&(d=e("link[media=print]")),r.stylesheet)for((e.isArray?e.isArray:Array.isArray)(r.stylesheet)||(r.stylesheet=[r.stylesheet]),s=0;s<r.stylesheet.length;s++)d=e.merge(d,e('<link rel="stylesheet" href="'+r.stylesheet[s]+'">'));f=t(l,!0,!0),(f=e("<span/>").append(f)).find(r.noPrintSelector).remove(),f.append(t(d)),r.title&&(0===(p=e("title",f)).length&&(p=e("<title />"),f.append(p)),p.text(r.title)),f.append(n(r.append)),f.prepend(n(r.prepend)),r.manuallyCopyFormValues&&(f.find("input").each((function(){var t=e(this);t.is("[type='radio']")||t.is("[type='checkbox']")?t.prop("checked")&&t.attr("checked","checked"):t.attr("value",t.val())})),f.find("select").each((function(){e(this).find(":selected").attr("selected","selected")})),f.find("textarea").each((function(){var t=e(this);t.text(t.val())}))),u=f.html();try{r.deferred.notify("generated_markup",u,f)}catch(e){console.warn("Error notifying deferred",e)}if(f.remove(),r.iframe)try{o(u,r)}catch(e){console.error("Failed to print from iframe",e.stack,e.message),a(u,r)}else a(u,r);return this}}(jQuery);